{"version":3,"file":"app.js","mappings":";;;;;AAAA,qEAAqE,kBAAkB,gBAAgB,yBAAyB;AAChI;AACA,iBAAiB;AACjB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB,UAAU,WAAW;AACrB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,wCAAwC;AACrD,wBAAwB,wCAAwC;AAChE,iBAAiB,gCAAgC;;AAEjD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,8CAA8C;AACpG;AACA,0DAA0D,8CAA8C;AACxG,0DAA0D,8CAA8C;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,4BAA4B;AAClG;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0CAA0C;AAC5D,oBAAoB;AACpB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,4BAA4B;AACvF;AACA;AACA,KAAK;AACL;AACA;AACA,6DAA6D,4BAA4B;AACzF;AACA;AACA,KAAK;AACL;AACA;AACA,6DAA6D,4BAA4B;AACzF;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,YAAY,OAAO,wDAAwD,IAAI,YAAY;AACzK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA,4CAA4C,OAAO;AACnD;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C","sources":["webpack://gajwa-playground/./public/rebuild.js"],"sourcesContent":["console.log(\"%c@ MYZY.SPACE 2021 POWERED BY MYZY_\", \"color: #00ff00; font-weight: 900; font-size: 1em; background-color: black; padding: 1rem\");\nconst font = new FontFaceObserver('dgm').load();\nconst display = {width : 320, height: 640, centerW : 160, centerH: 320 };\nconst fontConfig = {font: '32px \"dgm\"', color: '#fff'};\nconst config = {\n    type: Phaser.AUTO,\n    width: display.width,\n    height: display.height,\n    physics: {\n        default: 'arcade',\n        arcade: {\n            //debug: true\n        }\n    },\n    scene: {\n        preload: preload,\n        create: create,\n        update: update\n    },\n    parent: 'canvas',\n    pixelArt: true,\n    plugins: {\n        scene: [\n            {\n                key: \"PhaserNavMeshPlugin\", // Key to store the plugin class under in cache\n                plugin: PhaserNavMeshPlugin, // Class that constructs plugins\n                mapping: \"navMeshPlugin\", // Property mapping to use for the scene, e.g. this.navMeshPlugin\n                start: true\n            },\n        ]\n    }\n};\nconst game = new Phaser.Game(config);\nconst mainObject = {\n    player : 'main player',\n    dom : 'dom'\n};\nconst object = {};\n// TODO 설정\nconst path = new Map();\nconst moveTargets = {\n    player: {x: 0, y: 0},\n    dom: {x: 0, y: 0},\n    engineer: {x: 0, y: 0}\n};\nconst mainConfig = {\n    debugMode : true,\n    debugModeChapter: 2,\n    \n    playerMovable : false,\n    domFollow: false,\n\n    // 이동 후 바라볼 오브젝트\n    lookAt: {player: null, dom: null, engineer: null},\n    moveFinishedEvent: {player: null, dom: null, engineer: null},\n    pathCount: { player: 0, dom: 0, engineer: 0 },\n\n    // ui 설정\n    titleFadeOut : null,\n\n    // game 설정\n    seedNum : 0,\n    pcTimerPushed : false,\n    pcTimer : 0,\n    pcCrackCount : 0,\n    clear : [false, false, false, false, false],\n    reward: [0, 0, 0, 0, 0],\n    bridgeSelection: 0,\n    bridgeAnswer : [1, 2, 5, 7, 8],\n    bridgeFail : [0, 3, 4, 6, 9]\n}\nconst timer = {};\nconst event = {};\nconst maps = {};\nconst ui = {};\nconst line = {};\nconst debug = {};\nconst status = {\n    scene: 'title',\n    index: 0,\n    chapterIdx: 0,\n    taskIdx: 0\n};\n\nfunction preload() {\n    // TODO 프리로드\n    // data\n    this.load.json('text', 'data/text.json');\n    // tile\n    this.load.tilemapTiledJSON(\"map\", \"map/newmap.json\");\n    this.load.image(\"tileset\", \"map/set.png\");\n    // sprites\n    this.load.aseprite('character', 'image/character.png', 'image/character.json');\n    this.load.atlas('obj', 'image/obj.png', 'image/obj.json');\n    // UI\n    this.load.image('transition', 'image/transition0.png');\n    this.load.image('nineslice', 'image/nineslice.png');\n    this.load.image('nineslice-task', 'image/nineslice-task.png');\n    this.load.spritesheet('mark', 'image/mark.png', { frameWidth: 32, frameHeight: 32, endFrame: 1 });\n    this.load.image(\"pc\", \"image/pc.png\");\n    this.load.spritesheet('pc-err', 'image/pc-err.png', { frameWidth: 96, frameHeight: 80, endFrame: 5 });\n    this.load.spritesheet('bridge', 'image/bridge.png', { frameWidth: 32, frameHeight: 32, endFrame: 9 });\n    this.load.atlas('keyboard', 'image/keyboard.png', 'image/keyboard.json');\n    // plugins\n    this.load.plugin('rexninepatchplugin', 'rexninepatchplugin.min.js', true);\n    // particle\n    this.load.atlas(\"leaf\", \"image/leaf.png\", 'image/leaf.json');\n}\nfunction create() {\n    setLines(this);\n    setAnimations(this);\n    createGraphics(this);\n    createUIObjects(this);\n    createCharacters(this);\n    createObjects(this);\n    createParticles(this);\n    buildMap(this);\n    setLayer(this);\n    this.input.on('pointerup', pointer => {\n        if(!mainConfig.playerMovable) return;\n        mainConfig.pathCount.player = 1;\n        path.set('player', maps.navMesh.findPath(mainObject.player, { x: pointer.x, y: pointer.y }));\n        if(path.get('player') === null || path.get('player').length < 1) return;\n        moveCharacter('player');\n        //path_log();\n    });\n}\nfunction update() {\n    // TODO 업데이트 프레임\n    let dis = {\n        player: Phaser.Math.Distance.Between(mainObject.player.x, mainObject.player.y, moveTargets.player.x, moveTargets.player.y),\n        dom: Phaser.Math.Distance.Between(mainObject.dom.x, mainObject.dom.y, moveTargets.dom.x, moveTargets.dom.y),\n        engineer: Phaser.Math.Distance.Between(mainObject.engineer.x, mainObject.engineer.y, moveTargets.engineer.x, moveTargets.engineer.y),\n\n        each: Phaser.Math.Distance.Between(mainObject.player.x, mainObject.player.y, mainObject.dom.x, mainObject.dom.y),\n    }\n    if (mainObject.player.body.speed > 0){\n        if (dis.player < 4){\n            // 목적지 도착시 플레이어 정지\n            let playerPath = path.get('player');\n            if(playerPath === null || playerPath.length < 1 || playerPath.length === mainConfig.pathCount.player + 1) {\n                mainObject.player.body.reset(mainObject.player.x, mainObject.player.y);\n                if(mainObject.player.anims.currentAnim.key !== 'player-stand') mainObject.player.play('player-stand');\n                moveFinished(mainObject.player);\n            }\n            // 다음 경로로 변경\n            else {\n                mainConfig.pathCount.player++;\n                moveCharacter('player');\n            }\n        }\n        // 플레이어와 멀때 따라가기 경로\n        if(dis.each > 80 && mainConfig.domFollow){\n            moveToPoint('dom', mainObject.player.x, mainObject.player.y, true);\n        }\n    }\n    if (mainObject.dom.body.speed > 0){\n        if (dis.dom < 4){\n            // 목적지 도착시 정지\n            if(path.get('dom') === null || path.get('dom').length < 1 || path.get('dom').length === mainConfig.pathCount.dom + 1) {\n                mainObject.dom.body.reset(mainObject.dom.x, mainObject.dom.y);\n                if(mainObject.dom.anims.currentAnim.key !== 'dom-stand') mainObject.dom.play('dom-stand');\n                moveFinished(mainObject.dom);\n            }\n            // 다음 경로로 변경\n            else {\n                mainConfig.pathCount.dom++;\n                moveCharacter('dom');\n            }\n        }\n        // 플레이어와 가까울때 정지\n        else if(dis.each < 40 && mainConfig.domFollow){\n            mainObject.dom.body.reset(mainObject.dom.x, mainObject.dom.y);\n            if(mainObject.dom.anims.currentAnim.key !== 'dom-stand') mainObject.dom.play('dom-stand');\n\n        }\n    }\n    if (mainObject.engineer.body.speed > 0){\n        if (dis.engineer < 4){\n            // 목적지 도착시 정지\n            if(path.get('engineer') === null || path.get('engineer').length < 1 || path.get('engineer').length === mainConfig.pathCount.engineer + 1) {\n                mainObject.engineer.body.reset(mainObject.engineer.x, mainObject.engineer.y);\n                if(mainObject.engineer.anims.currentAnim.key !== 'engineer-stand') mainObject.engineer.play('engineer-stand');\n                moveFinished(mainObject.engineer);\n            }\n            // 다음 경로로 변경\n            else {\n                mainConfig.pathCount.engineer++;\n                moveCharacter('engineer');\n            }\n        }\n    }\n    // 레이어 순서 정렬\n    mainObject.group.list.sort(function(a, b) {\n        return a.y > b.y ? 1 : -1;\n    });\n    if(mainConfig.pcTimerPushed && !mainConfig.clear[0]) mainConfig.pcTimer++;\n    if(mainConfig.pcTimer > 140) {\n        mainConfig.pcTimerPushed = false;\n        mainConfig.pcTimer = 0;\n        pcShutDown('power');\n    }\n}\n\n// TODO 오브젝트 생성\nfunction buildMap(scene) {\n    // 타일맵 생성 <br>\n    // 네비메쉬 : maps.navMesh <br>\n    // 벽 레이어 : maps.wallLayer\n    maps.tilemap = scene.add.tilemap(\"map\");\n    maps.tileset = maps.tilemap.addTilesetImage(\"tileset\", \"tileset\");\n    maps.tilemap.createLayer(\"bg\", maps.tileset);\n    maps.wallLayer = [];\n    maps.objectLayer = [];\n\n    for (let i = 0; i < 3; i++) {\n        maps.wallLayer[i] = maps.tilemap.createLayer(\"display\" + i, maps.tileset).setVisible(false);\n        maps.objectLayer[i] = maps.tilemap.getObjectLayer(i.toString());\n    }\n    maps.navMesh = scene.navMeshPlugin.buildMeshFromTiled(\"mesh\", maps.objectLayer[0], 12.5);\n}\nfunction createCharacters(scene) {\n    // 메인 캐릭터 생성 <br>\n    // 플레이어 오브젝트 : mainObject.player\n    mainConfig.anims = scene.anims.createFromAseprite('character');\n    let chracterData = scene.cache.json.get('character').meta.frameTags;\n    for (let i = 0; i < chracterData.length; i++) {\n        if(chracterData[i].repeat === undefined) mainConfig.anims[i].repeat = -1;\n        else mainConfig.anims[i].repeat = chracterData[i].repeat;\n        if(chracterData[i].frameRate === undefined) mainConfig.anims[i].frameRate = 2;\n        else mainConfig.anims[i].frameRate = chracterData[i].frameRate;\n    }\n\n    mainObject.player = scene.physics.add.sprite(display.centerW, 180)\n        .setOrigin(0.5, 1).setScale(2).setSize(16, 16).setOffset(8, 16).play('player-stand');\n    mainObject.dom = scene.physics.add.sprite(display.centerW - 60, 180)\n        .setOrigin(0.5, 1).setScale(2).setSize(16, 16).setOffset(8, 16).play('dom-stand').setVisible(false);\n    mainObject.engineer = scene.physics.add.sprite(display.centerW, display.centerH + 80)\n        .setOrigin(0.5, 1).setScale(2).setSize(16, 16).setOffset(8, 16).play('engineer-stand').setVisible(false);\n    mainObject.man = scene.physics.add.sprite(display.centerW + 92, display.centerH - 16).play('man-stand')\n        .setOrigin(0.5, 1).setScale(2).setSize(16, 16).setOffset(8, 16).setFlipX(true).setVisible(false);\n}\nfunction createGraphics(scene) {\n    // TODO 그래픽 생성\n    // 디버그 그래픽\n    debug.graphics = scene.add.graphics();\n    debug.graphics.lineStyle(1, 0x00ff00, 1);\n    debug.graphics.fillStyle( 0xff0000, 1);\n}\nfunction createUIObjects(scene) {\n    // TODO UI 오브젝트 생성\n    ui.cam = scene.cameras.main;\n    ui.skip = scene.add.rectangle(display.centerW, display.centerH, display.width, display.height, 0x00ff00, 0)\n        .setInteractive();\n    ui.white = scene.add.rectangle(display.centerW, display.centerH, display.width, display.height, 0xffffff);\n    ui.background = scene.add.rectangle(display.centerW, display.centerH, display.width, display.height, 0x000000);\n    ui.dark = scene.add.rectangle(display.centerW, display.centerH, display.width, display.height, 0x000000).setVisible(false);\n    ui.title = scene.add.sprite(display.centerW, 180, 'obj', 'title').setOrigin(0.5).setScale(2);\n    ui.largeText = scene.add.text(display.centerW, display.centerH, '', fontConfig)\n        .setAlign('center').setOrigin(0.5).setVisible(false);\n    ui.mark = scene.add.sprite(display.centerW - 60, 180, 'mark').play('mark')\n        .setOrigin(0.5, 1).setScale(2).setVisible(false);\n\n    ui.next = scene.add.rectangle(display.centerW, display.height - 30, display.width, 60, 0x00ff00).setVisible(false);\n    scene.physics.add.existing(ui.next);\n\n    // 미니게임 창 생성\n    ui.gameGroup = scene.add.container();\n    ui.gameBackground = scene.add.rectangle(display.centerW, display.centerH, display.width, display.height, 0x000000);\n    ui.gameTransitionUp = scene.add.sprite(display.centerW, 0, 'transition').setOrigin(0.5, 1).setFlipY(true).setScale(2);\n    ui.gameTransitionDown = scene.add.sprite(display.centerW, display.height, 'transition').setOrigin(0.5, 0).setScale(2);\n    ui.pc = scene.add.sprite(display.centerW, display.centerH, 'pc').setOrigin(0.5).setScale(2);\n    ui.pcOff = scene.add.rectangle(display.centerW, display.centerH - 137, 188, 158, 0xffffff).setVisible(false);\n    ui.pcErr = scene.add.sprite(display.centerW, display.centerH - 136).play('pc-err').setOrigin(0.5).setScale(2);\n    ui.pcDown = scene.add.sprite(display.centerW, display.centerH - 136, 'keyboard', 'down').setOrigin(0.5).setScale(2).setVisible(false);\n    ui.pcCrack = scene.add.sprite(display.centerW - 62, display.centerH + 60, 'keyboard', 'crack0').setOrigin(1).setScale(2).setVisible(false);\n    ui.pcBreak = scene.add.rectangle(display.centerW - 16, display.centerH + 48, 210, 100, 0x0000f00, 0).setInteractive().on('pointerup', pointer => {\n        createParts(pointer.x, pointer.y, RandomPlusMinus() * 200, -100 + Math.random() * -400);\n    });\n    ui.pcPw = scene.add.container();\n    ui.pcPwList = [];\n    ui.pcInfo = '';\n    for (let i = 0; i < 4; i++) {\n        ui.pcPwList[i] = scene.add.text(92.5 + i * 36, 168, '*', fontConfig).setFontSize(48).setVisible(false);\n    }\n    ui.pcPw.add(ui.pcPwList);\n    ui.keyboard = scene.add.container();\n    function setKeyboard() {\n        let keys = [];\n        let pos = {x: 0, y: 0};\n        for (let i = 0; i < 14; i++) {\n            let index = null;\n            if(i === 10){\n                index = 'enter-';\n                pos.x = 238;\n                pos.y = 514;\n            }\n            else if(i === 11){\n                index = 'esc-';\n                pos.x = 38;\n                pos.y = 482;\n            }\n            else if(i === 12){\n                index = 'danger-';\n                pos.x = 38;\n                pos.y = 540;\n            }\n            else if(i === 13){\n                index = 'power-';\n                pos.x = 254;\n                pos.y = 340;\n            }\n            else{\n                index = i;\n                pos.x = 38 + (i * 20);\n                pos.y = 510;\n            }\n            keys[i] = scene.add.sprite(pos.x, pos.y, 'keyboard', index + 't').setScale(2).setInteractive();\n            keys[i].on('pointerdown', function () {\n                this.setTexture('keyboard', index + 'f');\n                if(index === 'power-') {\n                    mainConfig.pcTimerPushed = true;\n                    mainConfig.pcTimer = 0;\n                }\n            });\n            keys[i].on('pointerup', function () {\n                this.setTexture('keyboard', index + 't');\n                keyboardAction(index);\n                if(index === 'power-') mainConfig.pcTimerPushed = false;\n            });\n            keys[i].on('pointerout', function () {\n                this.setTexture('keyboard', index + 't');\n                if(index === 'power-') mainConfig.pcTimerPushed = false;\n            });\n        }\n        ui.keyboard.add(keys);\n        }\n    setKeyboard();\n\n    // 클릭 효과 생성\n    ui.pcParts = scene.physics.add.group({\n        visible: false,\n        active: false,\n        frameQuantity: 10,\n        maxSize: 10\n    });\n    ui.effectGroup = scene.add.container();\n    ui.bottom = scene.add.rectangle(display.centerW, display.height + 80, 4000, 10, 0x000000, 0);\n    scene.physics.add.overlap(ui.bottom, ui.pcParts, disableParts, null, this);\n    scene.physics.add.existing(ui.bottom);\n    ui.effectGroup.add(ui.bottom);\n    function disableParts(bottom, parts) {\n        // 떨어진 나사 제거\n        parts.disableBody(true, true);\n    }\n    // 스테이지 별 미니게임 씬 오브젝트 추가\n    // 징검다리 생성\n    ui.bridges = [];\n    let bridgeR = 1;\n    for (let i = 0; i < 10; i++) {\n        let h = 68;\n        let side = 0;\n        let line = 0;\n        if(i % 2 === 0) {\n            bridgeR *= -1;\n            line += h * (i / 2);\n            side = bridgeR * 16;\n        }\n        else {\n            line += h * (i / 2) - h * 0.5;\n            side = bridgeR * 16 - 48;\n        }\n        ui.bridges[i] = scene.add.sprite(display.centerW + side,\n            160 + line, 'bridge').setScale(2).setOrigin(0.5, 0);\n    }\n    ui.gameScene = [];\n    ui.gameScene[0] = scene.add.container().add([ui.pc, ui.pcCrack, ui.keyboard, ui.pcErr, ui.pcPw, ui.pcDown, ui.pcOff, ui.pcBreak]);\n    ui.gameScene[1] = scene.add.container();\n    ui.bridges.forEach(function (bridge, index) {\n        ui.gameScene[1].add(bridge);\n        bridge.on('pointerup', function () {\n            selectBridge(index, bridge);\n        });\n    });\n\n    ui.gameGroup.add([ui.gameBackground, ui.gameTransitionDown, ui.gameTransitionUp]).setVisible(false);\n    // 게임 씬 배열만큼 게임그룹에 추가\n    ui.gameScene.forEach(scenes => {\n        ui.gameGroup.add(scenes);\n    });\n\n    ui.dialogGroup = scene.add.container();\n    ui.dialogBox = scene.add.rexNinePatch({\n        x: display.centerW, y: display.height - 10,\n        width: (display.width - 20) * 0.5, height: 180 * 0.5,\n        key: 'nineslice',\n        columns: [8, undefined, 8],\n        rows: [8, undefined, 8],\n    }).setOrigin(0.5, 1).setScale(2);\n    ui.dialog = scene.add.text(30, display.height - 160, '', fontConfig).setFontSize(16).setLineSpacing(4);\n    ui.dialogGroup.add([ui.dialogBox, ui.dialog]).setVisible(false);\n    ui.taskGroup = scene.add.container();\n    ui.task = scene.add.text(42, 34, '', fontConfig).setFontSize(16).setLineSpacing(4);\n    ui.taskBox = scene.add.rexNinePatch({\n        x: display.centerW, y: 64,\n        width: (display.width - 20) * 0.5, height: 32,\n        key: 'nineslice-task',\n        columns: [15, undefined, 15],\n        rows: [0, undefined, 0],\n    }).setOrigin(0.5, 1).setScale(2);\n    ui.taskGroup.add([ui.taskBox, ui.task]);\n    ui.taskGroup.y = -64;\n    ui.rewardBox = scene.add.rexNinePatch({\n        x: 0, y: 0,\n        width: 120, height: 32,\n        key: 'nineslice',\n        columns: [8, undefined, 8],\n        rows: [8, undefined, 8],\n    }).setOrigin(0).setScale(2);\n    ui.rewardMsg = scene.add.text(120, 32, '', fontConfig).setFontSize(16).setOrigin(0.5).setLineSpacing(4);\n    ui.rewardGroup = scene.add.container().setPosition(160 - 120, 320 - 40).setVisible(false);\n    ui.rewardGroup.add([ui.rewardBox, ui.rewardMsg]);\n\n    ui.skip.on('pointerup', function () {\n        skip();\n    });\n}\nfunction setTask(visible) {\n    let scene = game.scene.scenes[0];\n    let pos;\n    let ease;\n    if (visible){\n        pos = 0;\n        ease = Phaser.Math.Easing.Quintic.Out;\n        ui.task.text = line.task[status.chapterIdx][status.taskIdx];\n        status.taskIdx++;\n    }\n    else {\n        ease = Phaser.Math.Easing.Quintic.In;\n        pos = -64;\n    }\n\n    scene.tweens.add({\n        targets: ui.taskGroup,\n        y: pos,\n        duration: 1200,\n        ease: ease\n    });\n}\nfunction createParticles(scene) {\n    // 파티클 생성\n    let emitZone = new Phaser.Geom.Rectangle(-200, -600, 200, 1200);\n    mainObject.particles = scene.add.particles('obj', 'particle');\n    let emitter = mainObject.particles.createEmitter({\n        x: 0,\n        y: 0,\n        speed: 80,\n        gravityX: 120,\n        gravityY: 120,\n        lifespan: 6000,\n        quantity: 0.5,\n        scale: 2,\n        emitZone: { source: emitZone }\n    });\n    let titlezone = new Phaser.Geom.Rectangle(0, -60, display.width, 10);\n\n    mainObject.TitleParticle = scene.add.particles('leaf');\n    mainObject.TitleEmitter = mainObject.TitleParticle.createEmitter({\n        frame: [ '0', '1', '2', '3'],\n        x: 0,\n        y: 0,\n        speed: 60,\n        gravityX: 0,\n        gravityY: 60,\n        lifespan: 6000,\n        quantity: 1,\n        frequency: 400,\n        scale: 2,\n        rotate: { start: 0, end: 360, ease: 'Back.easeOut' },\n        emitZone: { source: titlezone }\n    });\n}\nfunction createObjects(scene) {\n    // 기타 오브젝트 생성\n    object.list = [];\n    object.list[0] = scene.add.sprite(0, 336, 'obj', 'rock').setScale(2).setOrigin(0, 1).setVisible(false);\n    object.list[1] = scene.add.sprite(display.width - 80, 368, 'obj', 'rock').setScale(2).setOrigin(0, 1).setVisible(false);\n    object.list[2] = scene.add.sprite(96, 368, 'obj', 'pc').setScale(2).setOrigin(0, 1).setVisible(false);\n\n}\nfunction setLayer(scene) {\n    // TODO 레이어 및 그룹 오브젝트 생성\n    mainObject.layer = scene.add.layer();\n\n    mainObject.group = scene.add.container();\n    mainObject.group.add([mainObject.player, mainObject.dom, mainObject.engineer, mainObject.man]);\n    mainObject.group.add(object.list);\n\n    ui.group = scene.add.container();\n    ui.group.add([ui.background, ui.mark, ui.next, ui.gameGroup, ui.dialogGroup, ui.rewardGroup, ui.taskGroup, ui.largeText, ui.white, ui.title, ui.dark, ui.skip]);\n\n    // 레이어 정렬\n    mainObject.layer.add(mainObject.group);\n    mainObject.layer.add(mainObject.particles);\n    mainObject.layer.add(ui.group);\n    mainObject.layer.add(ui.effectGroup);\n    mainObject.layer.add(mainObject.TitleParticle);\n}\nfunction setAnimations(scene) {\n    // TODO 애니메이션 추가\n    scene.anims.create({\n        key: 'mark',\n        frames: scene.anims.generateFrameNumbers('mark', { start: 0, end: 1, first: 0 }),\n        frameRate: 2,\n        repeat: -1\n    });\n    scene.anims.create({\n        key: 'pc-err',\n        frames: scene.anims.generateFrameNumbers('pc-err', { start: 0, end: 5, first: 0 }),\n        frameRate: 24,\n        repeat: -1\n    });\n    scene.anims.create({\n        key: 'bridge',\n        frames: scene.anims.generateFrameNumbers('bridge', { start: 0, end: 9, first: 0 }),\n        frameRate: 24\n    });\n}\nfunction setLines(scene) {\n    // TODO 텍스트 데이터 생성 및 정리\n    let jsonText = scene.cache.json.get('text');\n    line.chapter = jsonText.chapter;\n    line.task = jsonText.task;\n    line.opening = jsonText.opening;\n    line.story = jsonText.story;\n    console.log(line);\n}\n\n// TODO 동작 메서드\nfunction Move(character, target, speed) {\n    game.scene.scenes[0].physics.moveToObject(character, target, speed);\n}\nfunction moveCharacter(character) {\n    let speed = 160;\n    if(character === 'engineer') speed = 80;\n    moveTargets[character].x = path.get(character)[mainConfig.pathCount[character]].x;\n    moveTargets[character].y = path.get(character)[mainConfig.pathCount[character]].y;\n    if(mainObject[character].anims.currentAnim.key !== character + '-run') mainObject[character].play(character + '-run');\n    mainObject[character].setFlipX(mainObject[character].x - moveTargets[character].x > 0);\n    Move(mainObject[character], moveTargets[character], speed);\n}\nfunction moveToPoint(character, x, y, withPath){\n    if(character === 'player'){\n        mainConfig.playerMovable = false;\n    }\n    mainConfig.pathCount[character] = 1;\n    let newPath = (withPath) ? maps.navMesh.findPath(mainObject[character], { x: x, y: y }) : [{ x: mainObject[character].x, y: mainObject[character].y }, { x: x, y: y }];\n    path.set(character, newPath);\n    if(path.get(character) === null || path.get(character).length < 1) return;\n    moveCharacter(character);\n}\nfunction path_log() {\n    debug.graphics.clear();\n    if(path.get('player') === null) {\n        return;\n    }\n    let line = new Phaser.Curves.Path(mainObject.player.x, mainObject.player.y);\n    for (let i = 0; i < path.get('player').length; i++)\n    {\n        line.lineTo(path.get('player')[i].x, path.get('player')[i].y);\n        debug.graphics.fillRect(path.get('player')[i].x - 4, path.get('player')[i].y - 4, 8, 8);\n    }\n    debug.graphics.lineStyle(1, 0xff0000, 1);\n    line.draw(debug.graphics);\n}\nfunction RandomPlusMinus() {\n    return (Math.random() > 0.5) ? 1 : -1;\n}\nfunction RandomizePos(obj, x, y, min, max) {\n    obj.x = x + min + Math.random() * max * RandomPlusMinus();\n    obj.y = y + min + Math.random() * max * RandomPlusMinus();\n}\nfunction shakeObject(obj, max, speed, time) {\n    if(timer.shaker !== undefined) return;\n    const x = obj.x;\n    const y = obj.y;\n    setTimeout(()=> {\n        clearTimeout(timer.shaker);\n        timer.shaker = undefined;\n        obj.x = x;\n        obj.y = y;\n    }, time);\n    repeat();\n    function repeat() {\n        RandomizePos(obj, x, y, 0, max);\n        timer.shaker = setTimeout(repeat, speed);\n    }\n}\nfunction typewriteText(object, txt, speed) {\n    eventByIndex();\n    if(txt === undefined) return;\n    game.scene.scenes[0].time.removeEvent(event.type);\n    const length = txt.length\n    // 타이핑 도중에 재실행\n    if(event.typing === true){\n        event.typing = false;\n        object.text = txt;\n        status.index++;\n    }\n    else {\n        object.text = '';\n        let i = 0;\n        event.type = game.scene.scenes[0].time.addEvent({\n            callback: () => {\n                object.text += txt[i]\n                ++i\n                if(i < length){\n                    event.typing = true;\n                }\n                else {\n                    // 타이핑이 끝나고 실행\n                    event.typing = false;\n                    object.text = txt;\n                    status.index++;\n                }\n            },\n            repeat: length - 1,\n            delay: speed\n        })\n    }\n}\nfunction keyboardAction(key) {\n    if(mainConfig.clear[0]) return;\n    if(key < 10){\n        if(ui.pcInfo.length === 4) return;\n        ui.pcInfo += '' + key;\n        ui.pcDown.setVisible(false);\n    }\n    if(key === 'esc-'){\n        ui.pcInfo = '';\n        ui.pcDown.setVisible(false);\n    }\n    if(key === 'danger-'){\n        ui.pcInfo = '';\n        ui.pcDown.setVisible(true);\n    }\n    if(key === 'enter-'){\n        if(ui.pcDown.visible === true){\n            pcShutDown('danger');\n        }\n        else {\n            if(ui.pcInfo.length === 4){\n                if(ui.pcInfo === '1234'){\n                    pcShutDown('1234');\n                }\n                else if(ui.pcInfo === '0000'){\n                    pcShutDown('0000');\n                }\n                else {\n                    for (let i = 0; i < 4; i++) {\n                        shakeObject(ui.pcPw, 10, 10, 240);\n                        setTimeout(function () {\n                            ui.pcInfo = '';\n                            for (let i = 0; i < 4; i++) {\n                                ui.pcPwList[i].setVisible(false);\n                            }\n                        }, 420);\n                    }\n                }\n            }\n        }\n    }\n    for (let i = 0; i < 4; i++) {\n        ui.pcPwList[i].setVisible(false);\n    }\n    for (let i = 0; i < ui.pcInfo.length; i++) {\n        ui.pcPwList[i].setVisible(true);\n    }\n}\nfunction pcShutDown(way) {\n    const newline = new Map();\n    newline.set('1234', \"[폰 왈도 노이만 3세]\\n어떻게 비밀번호를 알아냈지?!\\n천재가 분명해! 자네..\")\n        .set('0000', \"[폰 왈도 노이만 3세]\\n초기화 패스워드 0000이라..자네..\\n나랑 일해볼 생각 없나..?\")\n        .set('power', \"[폰 왈도 노이만 3세]\\n파워를 직접적으로 차단한다라..\\n자네.. 컴퓨터를 좀 아는군?\")\n        .set('danger', \"[폰 왈도 노이만 3세]\\n그 버튼은 무서워서 단 한번도\\n못 눌러봤는데.. 대담한 친구로군..\")\n        .set('break', \"[폰 왈도 노이만 3세]\\n아니..커..컴퓨터가..\\n과격한 친구로군.. 어쨋든 오작동은\\n멈췄으니.. 성공했다고 봐야겠어.\");\n    const reward = new Map();\n    // 씨앗 리워드 결정\n    reward.set('1234', 3)\n        .set('0000', 4)\n        .set('power', 5)\n        .set('danger', 1)\n        .set('break', 2);\n    mainConfig.reward[0] = reward.get(way);\n    line.story[1][14] = newline.get(way);\n    let scene = game.scene.scenes[0];\n    mainConfig.clear[0] = true;\n    ui.pcOff.setVisible(true);\n    scene.tweens.addCounter({\n        from: 255,\n        to: 0,\n        duration: 1800,\n        ease: Phaser.Math.Easing.Quintic.In,\n        onUpdate: function (tween)\n        {\n            const value = Math.floor(tween.getValue());\n            ui.pcOff.setFillStyle(Phaser.Display.Color.GetColor(value, value, value));\n        },\n        onComplete: function () {\n            console.log('pc shut down');\n            setTask(false);\n            scene.tweens.add({\n                targets: ui.gameGroup,\n                y: -800,\n                duration: 1600,\n                ease: Phaser.Math.Easing.Quintic.In,\n                onComplete: function () {\n                    ui.gameGroup.setVisible(false);\n                    ui.skip.setVisible(true);\n                    ui.dialogGroup.setVisible(true);\n                    dialog();\n                }\n            });\n        }\n    });\n}\nfunction setReward(bool, count) {\n    if(bool){\n        setTimeout(() => ui.skip.setVisible(true), 400);\n        ui.rewardGroup.setVisible(true);\n        ui.rewardMsg.text = '씨앗을 ' + count + '개 받았다!'\n        mainConfig.seedNum += count;\n    }\n    else ui.rewardGroup.setVisible(false);\n}\nfunction setGameScenes() {\n    if(status.chapterIdx < 1) return;\n    for (let i = 0; i < ui.gameScene.length; i++) {\n        ui.gameScene[i].setVisible(false);\n    }\n    ui.gameScene[status.chapterIdx - 1].setVisible(true);\n}\nfunction createParts(x, y, vx, vy) {\n    // pc 부수기\n    if(mainConfig.clear[0]) return;\n    mainConfig.pcCrackCount++;\n    if(mainConfig.pcCrackCount === 10) ui.pcCrack.setVisible(true);\n    else if(mainConfig.pcCrackCount > 20 && mainConfig.pcCrackCount < 30){\n        ui.pcCrack.setTexture('keyboard', 'crack1').setOrigin(1);\n    }\n    else if(mainConfig.pcCrackCount > 30){\n        pcShutDown('break');\n        return;\n    }\n    let part =  ui.pcParts.get();\n    if (!part) return;\n    ui.effectGroup.add(part);\n    let r = Math.random();\n    if(r > 0 && 0.25 < r) part.setTexture('keyboard', 'parts0');\n    else if(r > 0.25 && 0.5 < r) part.setTexture('keyboard', 'parts1');\n    else if(r > 0.5 && 0.75 < r) part.setTexture('keyboard', 'parts2');\n    else part.setTexture('keyboard', 'parts3');\n    part\n        .setOrigin(0.5)\n        .setScale(2)\n        .setGravityY(0)\n        .setGravityY(800)\n        .enableBody(true, x, y, true, true)\n        .setVelocity(vx, vy)\n        .setAngularVelocity(400);\n\n}\nfunction selectBridge(index, bridge) {\n    if(Math.floor(index / 2) !== mainConfig.bridgeSelection) return;\n    if(index === mainConfig.bridgeAnswer[mainConfig.bridgeSelection]){\n        // 생존\n        console.log('success');\n        ui.bridges[mainConfig.bridgeFail[mainConfig.bridgeSelection]].play('bridge');\n    }\n    else {\n        console.log('failed');\n        bridge.play('bridge');\n    }\n    ui.bridges[mainConfig.bridgeAnswer[mainConfig.bridgeSelection]].disableInteractive();\n    ui.bridges[mainConfig.bridgeFail[mainConfig.bridgeSelection]].disableInteractive();\n    mainConfig.bridgeSelection++;\n    const number = {\n        1: '두 번째' ,\n        2: '세 번째' ,\n        3: '네 번째' ,\n        4: '마지막 '\n    }\n    if(mainConfig.bridgeSelection < 5){\n        ui.task.text = number[mainConfig.bridgeSelection] + \" 다리를 선택하자\";\n    }\n\n}\n\n// TODO 이벤트 메서드\nfunction skip() {\n    if(status.scene === 'title'){\n        if(mainConfig.debugMode){\n            mainObject.TitleEmitter.stop();\n            mainObject.TitleEmitter.setVisible(false);\n            ui.title.setVisible(false);\n            ui.white.setVisible(false);\n            chapterTitle(mainConfig.debugMode);\n            ui.background.setVisible(false);\n            ui.dark.setVisible(true);\n            return;\n        }\n        status.scene = 'opening';\n        mainObject.TitleEmitter.setGravityX(2000);\n        mainObject.TitleEmitter.stop();\n        game.scene.scenes[0].tweens.add({\n            targets: ui.title,\n            y: -120,\n            duration: 800,\n            ease: Phaser.Math.Easing.Quintic.In,\n            onComplete: function () {\n            }\n        });\n        game.scene.scenes[0].tweens.add({\n            targets: ui.white,\n            y: -display.height,\n            duration: 1200,\n            ease: Phaser.Math.Easing.Quintic.In,\n            onComplete: function () {\n                ui.largeText.setVisible(true);\n                ui.largeText.text = line.opening[status.index];\n                shakeObject(ui.largeText, 20, 20, 240);\n                status.index++;\n            }\n        });\n    }\n    else if(status.scene === 'opening'){\n        // 마지막 줄에서 챕터 씬으로 전환\n        if(line.opening[status.index] === undefined) {\n            if(mainConfig.titleFadeOut !== null) return;\n            chapterTitle(mainConfig.debugMode);\n        }\n        else {\n            ui.largeText.text = line.opening[status.index];\n            shakeObject(ui.largeText, 20, 20, 240);\n            status.index++;\n        }\n    }\n    else if(status.scene === 'chapter'){\n        if(ui.rewardGroup.visible === true){\n            setReward(false, null);\n            ui.dialogGroup.setVisible(true);\n        }\n        dialog();\n    }\n}\nfunction dialog() {\n    if(line.story[status.chapterIdx][status.index] === '*close*'){\n        mainObject.dom.play('dom-stand');\n        event.typing = false;\n        ui.dialogGroup.setVisible(false);\n        ui.skip.setVisible(false);\n        eventByIndex();\n        status.index++;\n    }\n    else {\n        typewriteText(ui.dialog, line.story[status.chapterIdx][status.index], 60);\n    }\n}\nfunction eventByIndex(){\n    let chapter = status.chapterIdx;\n    let index = status.index;\n    let scene = game.scene.scenes[0];\n\n    if(chapter === 0){\n        if(index === 4){\n            mainObject.player.play('player-seek');\n        }\n        if(index === 6){\n            setTask(true);\n            mainObject.player.play('player-stand');\n            let markOn = setTimeout(function () {\n                if(mainObject.dom.visible) {\n                    clearTimeout(markOn);\n                    markOn = undefined;\n                    return;\n                }\n                ui.mark.setVisible(true);\n            }, 3200);\n            setTimeout(() => mainConfig.playerMovable = true, 0);\n            let col = scene.physics.add.overlap(mainObject.player, mainObject.dom, function () {\n                col.active = false;\n                ui.mark.setVisible(false);\n                setVisibleObjects(true, [mainObject.dom, ui.skip, ui.dialogGroup]);\n                moveToPoint('player', mainObject.dom.x + 60, mainObject.dom.y, true);\n                mainConfig.lookAt.player = mainObject.dom;\n                mainConfig.lookAt.dom = mainObject.player;\n                dialog();\n                mainObject.dom.play('dom-talk');\n                setTask(false);\n            }, null, this);\n        }\n        if(index === 12){\n            setTask(true);\n            setTimeout(() => mainConfig.playerMovable = true, 20);\n            moveToPoint('dom', display.centerW, display.centerH + 80);\n            mainConfig.moveFinishedEvent.player = function () {\n                let col = scene.physics.add.overlap(mainObject.player, mainObject.dom, function () {\n                    col.active = false;\n                    setTask(false);\n                    setVisibleObjects(true, [ui.skip, ui.dialogGroup]);\n                    mainConfig.playerMovable = false;\n                    mainConfig.lookAt.player = mainObject.dom;\n                    mainConfig.lookAt.dom = mainObject.player;\n                    moveToPoint('player', mainObject.dom.x - 60, mainObject.dom.y, true);\n                    dialog();\n                    mainObject.dom.play('dom-talk');\n                }, null, this);\n            }\n        }\n        if(index === 19){\n            // 다음 스테이지로\n            setTask(true);\n            setTimeout(() => mainConfig.playerMovable = true, 0);\n            setTimeout(() => mainConfig.domFollow = true, 0);\n            let col = scene.physics.add.overlap(mainObject.player, ui.next, function () {\n                setTask(false);\n                console.log('to next stage');\n                status.chapterIdx++;\n                col.active = false;\n                mainConfig.domFollow = false;\n                ui.dark.setVisible(true).setAlpha(0);\n                moveToPoint('player', display.centerW, display.height + 180, false);\n                moveToPoint('dom', display.centerW, display.height + 180, false);\n                scene.tweens.add({\n                    targets: ui.dark,\n                    alpha: 1,\n                    duration: 2000,\n                    onComplete: () => chapterTitle(mainConfig.debugMode)\n                });\n            }, null, this);\n        }\n    }\n    if(chapter === 1) {\n        if (index === 3) {\n            setTask(true);\n            moveEnable();\n            let col = scene.physics.add.overlap(mainObject.player, mainObject.engineer, function () {\n                col.active = false;\n                setTask(false);\n                mainConfig.playerMovable = false;\n                mainConfig.domFollow = false;\n                mainConfig.lookAt.player = mainObject.engineer;\n                mainConfig.lookAt.engineer = mainObject.player;\n                moveToPoint('player', mainObject.engineer.x + 60, mainObject.engineer.y, true);\n                moveToPoint('dom', mainObject.engineer.x - 60, mainObject.engineer.y, true);\n                if(!ui.dialogGroup.visible) {\n                    ui.skip.setVisible(true);\n                    ui.dialogGroup.setVisible(true);\n                }\n                dialog();\n                mainObject.engineer.play('engineer-talk');\n            }, null, this);\n        }\n        else if (index === 7) {\n            mainObject.engineer.play('engineer-stand');\n        }\n        else if (index === 8) {\n            mainObject.engineer.play('engineer-talk');\n        }\n        else if (index === 13){\n            setTask(true);\n            ui.gameGroup.y = 600;\n            ui.gameGroup.setVisible(true);\n            scene.tweens.add({\n                targets: ui.gameGroup,\n                y: 0,\n                duration: 2000,\n                ease: Phaser.Math.Easing.Quintic.Out\n            });\n        }\n        else if (index === 16){\n            mainObject.engineer.play('engineer-stand');\n            setTimeout(function () {\n                setReward(true, mainConfig.reward[0]);\n            }, 400);\n        }\n        else if (index === 17) mainObject.engineer.play('engineer-talk');\n        else if (index === 19){\n            // 다음 스테이지로\n            setTask(true);\n            moveToPoint('engineer', 70, display.centerH + 40, true);\n            mainConfig.moveFinishedEvent.engineer = function () {\n                mainObject.engineer.play('engineer-type');\n                mainObject.engineer.setFlipX(false);\n            };\n            moveEnable();\n            let col = scene.physics.add.overlap(mainObject.player, ui.next, function () {\n                setTask(false);\n                console.log('to next stage');\n                status.chapterIdx++;\n                col.active = false;\n                mainConfig.domFollow = false;\n                ui.dark.setVisible(true).setAlpha(0);\n                moveToPoint('player', display.centerW, display.height + 180, false);\n                moveToPoint('dom', display.centerW, display.height + 180, false);\n                scene.tweens.add({\n                    targets: ui.dark,\n                    alpha: 1,\n                    duration: 2000,\n                    onComplete: () => chapterTitle(mainConfig.debugMode)\n                });\n            });\n        }\n    }\n    if(chapter === 2) {\n        if (index === 4) {\n            setTask(true);\n            moveEnable();\n            let col = scene.physics.add.overlap(mainObject.player, mainObject.man, function () {\n                col.active = false;\n                setTask(false);\n                mainConfig.playerMovable = false;\n                mainConfig.domFollow = false;\n                mainConfig.lookAt.player = mainObject.man;\n                mainConfig.lookAt.man = mainObject.player;\n                mainConfig.lookAt.dom = mainObject.man;\n                moveToPoint('player', mainObject.man.x + 44, mainObject.man.y + 32, true);\n                moveToPoint('dom', mainObject.man.x + 44, mainObject.man.y - 32, true);\n                if(!ui.dialogGroup.visible) {\n                    ui.skip.setVisible(true);\n                    ui.dialogGroup.setVisible(true);\n                }\n                dialog();\n                mainObject.man.play('man-talk');\n            }, null, this);\n        }\n        else if (index === 11) {\n            mainObject.man.play('man-stand');\n            mainObject.man.setFlipX(true);\n            ui.bridges.forEach(function (bridge) {\n                bridge.setInteractive();\n            });\n            setTask(true);\n        }\n    }\n}\nfunction moveEnable() {\n    setTimeout(function () {\n        mainObject.dom.play('dom-stand');\n        mainObject.player.play('player-stand');\n        mainConfig.playerMovable = true;\n        mainConfig.domFollow = true;\n    }, 0);\n}\nfunction setVisibleObjects(bool, arr) {\n    // 배열 오브젝트 모두 setVisible 실행\n    for (let i = 0; i < arr.length; i++) {\n        arr[i].setVisible(bool);\n    }\n}\nfunction moveFinished(character) {\n    // 이동 완료 후 바라보기\n    let name = '';\n    if(character === mainObject.player){\n        name = 'player';\n    }\n    else if(character === mainObject.dom){\n        name = 'dom';\n    }\n    else if(character === mainObject.engineer){\n        name = 'engineer';\n    }\n    if(mainConfig.moveFinishedEvent[name] !== null) {\n        mainConfig.moveFinishedEvent[name]();\n        mainConfig.moveFinishedEvent[name] = null;\n    }\n    if(mainConfig.playerMovable) return;\n    for(value in mainConfig.lookAt){\n        if(mainConfig.lookAt[value] !== null) {\n            mainObject[value].setFlipX(mainObject[value].x - mainConfig.lookAt[value].x > 0);\n        }\n    }\n}\n\n// TODO 씬 제어\nfunction chapterTitle(skip) {\n    ui.background.setVisible(true);\n    ui.dark.setVisible(false);\n    if(skip) {\n        // 디버그 씬 스킵\n        if(mainConfig.debugMode) {\n            status.chapterIdx = mainConfig.debugModeChapter;\n            if(mainConfig.debugModeChapter !== 0){\n                mainObject.dom.setVisible(true);\n                mainObject.particles.setVisible(false);\n            }\n        }\n        chapterStart(status.chapterIdx);\n        return;\n    }\n    let scene = game.scene.scenes[0];\n    ui.largeText.setAlpha(0);\n    ui.largeText.setVisible(true);\n    ui.largeText.text = line.chapter[status.chapterIdx];\n    mainConfig.titleFadeOut = scene.tweens.add({\n        targets: ui.largeText,\n        alpha: 1,\n        duration: 2400,\n        yoyo: true,\n        ease: Phaser.Math.Easing.Elastic.InOut,\n        onComplete: () => chapterStart(status.chapterIdx)\n    });\n\n    function chapterStart(chapterIdx) {\n        ui.background.setVisible(false);\n        ui.dark.setVisible(true);\n        let scene = game.scene.scenes[0];\n        setGameScenes();\n        mainConfig.titleFadeOut = null;\n        status.scene = 'chapter';\n        status.index = 0;\n        status.taskIdx = 0;\n        console.log(status.scene, status.chapterIdx);\n        game.scene.scenes[0].tweens.add({\n            targets: ui.dark,\n            alpha: 0,\n            duration: 1200,\n            onComplete: () => ui.dark.setVisible(false)\n        });\n        ui.largeText.setVisible(false);\n        if(chapterIdx === 0){\n            setVisibleObjects(true, [maps.wallLayer[0], object.list[0], object.list[1]]);\n            zoomOut(mainConfig.debugMode);\n            function zoomOut(on) {\n                if(on){\n                    ui.dialogGroup.setVisible(true);\n                    dialog();\n                    ui.skip.setInteractive();\n                }\n                else {\n                    ui.skip.disableInteractive();\n                    ui.cam.zoom = 4;\n                    ui.cam.pan(mainObject.player.x, mainObject.player.y - 32, 1);\n                    setTimeout(function () {\n                        ui.cam.pan(display.centerW, display.centerH, 2800, Phaser.Math.Easing.Quintic.InOut, true);\n                        ui.cam.zoomTo(1, 2800, Phaser.Math.Easing.Quintic.InOut);\n                        ui.cam.on(Phaser.Cameras.Scene2D.Events.ZOOM_COMPLETE, () => {\n                            ui.dialogGroup.setVisible(true);\n                            dialog();\n                            ui.skip.setInteractive();\n                        });\n                    }, 400);\n                }\n            }\n        }\n        else if(chapterIdx === 1){\n            ui.skip.setVisible(false);\n            maps.navMesh.destroy();\n            maps.wallLayer[0].setVisible(false);\n            maps.wallLayer[1].setVisible(true);\n            maps.navMesh = scene.navMeshPlugin.buildMeshFromTiled(\"mesh\", maps.objectLayer[1], 12.5);\n            setVisibleObjects(false, [object.list[0], object.list[1]]);\n            object.list[2].setVisible(true);\n            mainObject.particles.setVisible(false);\n            mainObject.engineer.setVisible(true);\n            mainObject.player.x = mainObject.dom.x = display.centerW;\n            mainObject.player.y = mainObject.dom.y = -80;\n\n            moveToPoint('player', display.centerW + 30, 100, false);\n            moveToPoint('dom', display.centerW - 30, 100, false);\n            mainConfig.moveFinishedEvent.player = function () {\n                mainConfig.lookAt.player = mainObject.dom;\n                mainConfig.lookAt.dom = mainObject.player;\n                if(!ui.dialogGroup.visible) {\n                    ui.skip.setVisible(true);\n                    ui.dialogGroup.setVisible(true);\n                }\n                dialog();\n            }\n            mainConfig.moveFinishedEvent.dom = function () {\n                mainObject.dom.play('dom-talk');\n            }\n        }\n        else if(chapterIdx === 2){\n            maps.navMesh.destroy();\n            ui.gameBackground.setVisible(false);\n            ui.gameGroup.setVisible(true);\n            ui.gameGroup.y = 0;\n            setVisibleObjects(false, [ui.skip, object.list[2], maps.wallLayer[1], mainObject.engineer]);\n            setVisibleObjects(true, [maps.wallLayer[2], mainObject.man]);\n            maps.navMesh = scene.navMeshPlugin.buildMeshFromTiled(\"mesh\", maps.objectLayer[2], 12.5);\n            mainObject.player.x = mainObject.dom.x = display.centerW - 120;\n            mainObject.player.y = mainObject.dom.y = -80;\n            moveToPoint('player', display.centerW + 30, 136, false);\n            moveToPoint('dom', display.centerW - 30, 136, false);\n            mainConfig.moveFinishedEvent.player = function () {\n                mainConfig.lookAt.player = mainObject.dom;\n                mainConfig.lookAt.dom = mainObject.player;\n                if(!ui.dialogGroup.visible) {\n                    ui.skip.setVisible(true);\n                    ui.dialogGroup.setVisible(true);\n                }\n                dialog();\n            }\n            mainConfig.moveFinishedEvent.dom = function () {\n                mainObject.dom.play('dom-talk');\n            }\n        }\n    }\n}"],"names":[],"sourceRoot":""}